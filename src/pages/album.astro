---
// src/pages/gallery.astro
import Layout from "@layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import { Image } from "astro:assets";

// Importa automaticamente tutte le immagini dalla cartella
const images = import.meta.glob(
  "/src/images/gallery/*.{jpeg,jpg,png,gif,webp}",
  { eager: true }
);

// Crea un array con le informazioni delle immagini
const galleryImages = Object.entries(images).map(([path, image]: [string, any]) => {
  // Estrai il nome del file senza estensione per l'alt text
  const filename = path.split("/").pop()?.split(".")[0] || "";
  return {
    image: image.default,
    alt: filename.replace(/-|_/g, " "), // Converte trattini/underscore in spazi
    path: path
  };
});
---

<Layout title="Galleria">
  <Header activeNav="gallery" />
  <main id="main-content">
    <section class="prose mx-auto max-w-6xl px-4 pb-12 pt-8">
      <h1 class="text-center mb-8">Galleria Fotografica</h1>
      
      {galleryImages.length === 0 ? (
        <p class="text-center text-gray-500">
          Nessuna immagine trovata. Aggiungi immagini in src/images/gallery/
        </p>
      ) : (
        <div class="gallery-grid">
          {galleryImages.map((item) => (
            <div class="gallery-item">
              <Image
                src={item.image}
                alt={item.alt}
                width={400}
                height={300}
                class="gallery-image"
                loading="lazy"
                format="webp"
              />
            </div>
          ))}
        </div>
      )}
    </section>
  </main>
  <Footer />
</Layout>

<style>
  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
    padding: 0;
  }
  
  .gallery-item {
    position: relative;
    overflow: hidden;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .gallery-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
  }
  
  .gallery-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    aspect-ratio: 4/3;
    display: block;
  }

  @media (max-width: 640px) {
    .gallery-grid {
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 1rem;
    }
  }
</style>